**Ejer:** Si la columna iris$Petal.Length tuviera valores 'NA', 
#Â¿CÃ³mo podrÃ???a eliminarlos antes de hacer la estimaciÃ³n de la media?
  
#na.rm = True
  
#Estime la media aritmÃ©tica de la altura, la longitud y el ancho del
#caparazÃ³n de las tortugas pintadas [data(tortues), paquete: *ade4*],
#use la funciÃ³n apply para obtener los estadÃ???sticos de cada medida en 
#un mismo vector.

library(ade4)
data("tortues")
View(tortues)

#Creo un nuevo vector con solo las columnas de clase numeric 

vector <- tortues[,c("long", "larg", "haut")]

#A este vector le aplico la función "mi.promedio" 

mi.promedio <- function(x) {
     
mi.suma<- sum(x)
mi.n<-length(x)
mi.prom <- mi.suma/mi.n
return(mi.prom) }

promedios <- apply(vector, 2, mi.promedio)

**Ejer:** Genere una funciÃ³n propia que le permita encontrar la mediana, 
tal y como lo hizo con la media aritmÃ©tica.

mi.mediana <- function(x) {
  
  y <- sort(x) #ordenas los valores de menos a mayor#
  n <- length(y) #buscar la longitud de este vector#
  e <- (n/2)
  d <- y[e] #encontrar el número que se encuentra en la posición n/2#
  return(d)
}

#la función da una aproximación de la mediana debido a que no tiene en 
#cuenta que el vector puede ser par o impar. 

**Ejer:** Genere una funciÃ³n propia que le permita calcular la moda

mi.moda <- function(x){

y <- table(x) #cuántas veces se repite cada valor de x #

d <- y[which.max(y)] #indexo la posición en donde se encuentra el máximo#

return(d)}

#**Ejer:** DespuÃ©s de generar la funciÃ³n del cÃ¡lculo de moda,
#grafÃ???quela sobre el histograma.

hist(setosa, # histogram
     col = "peachpuff", # column color
     border = "black", 
     prob = TRUE, # show densities instead of frequencies
     xlim = c(0.5,2.5),
     xlab = "Longitud de pÃ©talo",
     main = "Frecuencias de longitud de pÃ©talo de setosa")
lines(density(setosa),
      lwd = 2, # thickness of line
      col = "chocolate3") # Generar la distribuciÃ³n continua distribuciÃ³n de masa a partir de los datos observados

# Graficar la media
abline(v = mean(setosa),
       col = "royalblue",
       lwd = 2)

abline(v = median(setosa),
       col = "red",
       lwd = 2)

abline(v = 1.4 , col = "green", lwd =2 ) #conociendo el sabor de la moda#
        

legend(x = "topright", # location of legend within plot area
       c("Density plot", "Mean", "Median", "Moda"),
       col = c("chocolate3", "royalblue", "red", "green"),
       lwd = c(2, 2, 2,2))

#**Ejer:** Genere los cuantiles en intervalos de 0.5 Existen otras 
#funciones que nos permiten generar cuartiles, incluyendo informaciÃ³n 
#de tendencias centrales.Es decir, *density()* pero mÃ¡s resumido.#


quantile(setosa,probs = c(seq(0, 1, 0.05))) #cada cuántil va aumentando de
# 5 en 5. 

#**Ejer:** Â¿QuÃ© sucede si el nÃºmero de columnas deseado no se
#especifica? Obtenga la mediana, la moda y los cuantiles para cada
#especie de iris y para cada variable morfomÃ©trica.

aggregate(iris, list(Especies = iris$Species), mean) 

#si no se especifica ltabeos números de columnas, la función me tendrá en cuenta todas las variables
#y en el caso de "especies" me regresara NA debido a que son categoricas. 

aggregate(iris [,1:4], list(Especies = iris$Species), median)
aggregate(iris [,1:4], list(Especies = iris$Species), mi.moda)
aggregate(iris [,1:4], list(Especies = iris$Species), quantile)

#**Ejer:** grafique la distribuciÃ³n de frecuencias de cada poblaciÃ³n
#usando histograma y densidad en el mismo grÃ¡fico. Adiciones la media,
#la mediana y la moda.


par( mfrow=c(1,2), mar=c(4,4,1,0))
hist(pop1, breaks=20 , xlim=c(3,10) , ylim = c(0, 20) , col= "lightpink" , xlab="Longitud de colas" , ylab="Frecuencia" , main="" )
lines(density(pop1),lwd = 2,     col = "chocolate3") 


abline(v = mean(pop1),col = "lavenderblush4",lwd = 2)

abline(v = median(pop1), col = "lightsalmon", lwd = 2)

abline(v = 5,8 , col = "red", lwd =2 ) 

legend(x = "topright",
       c("Density plot", "Mean", "Median", "Moda"),
       col = c("chocolate3", "lavenderblush4", "lightsalmon", "lightpink4"), lwd = c(2, 2, 2,2))
hist(pop2, col= "lightblue1" , xlab="Longitud de colas" , ylab="" , main="")
lines(density(pop2),lwd = 2,     col = "chocolate3", breaks=20) 


abline(v = mean(pop2),col = "lavenderblush4",lwd = 2)

abline(v = median(pop2), col = "lightsalmon", lwd = 2)

abline(v = 5 , col = "red", lwd =2 ) 

legend(x = "topright",
       c("Density plot", "Mean", "Median", "Moda"),
       col = c("chocolate3", "lavenderblush4", "lightsalmon", "red"), lwd = c(2, 2, 2,2))

#**Ejer:** Lea el resumen y las grÃ¡ficas del articulo de Magund 2007. 
#Cargue los datos llamados '2007_EAA_Magud_et_al_data.csv' usando la 
#funciÃ³n read.csv(). Estime todos los estadÃ­sticos vistos en esta 
#prÃ¡ctica para las variables 'body length', 'tubercles 1b apart' y 
#'tarsus I length'. Grafique sus anÃ¡lisis y exportelos usando las 
#'funciones PNG o PDF. Escriba un pÃ¡rrafo de no mÃ¡s de 200 analizando 
#lo que encontrÃ³. Tenga en cuenta que solo describir las salidas implica 
#descripciÃ³n de resultados no anÃ¡lisis.

artículo <- read.csv("Semana4_Descriptores_Medidas/2007_EAA_Magud_et_al_data.csv")

#Cálculos para la variable "Body Lenght", denominada en el archivo como "A"

#Calcular la media

promedio <- sum(artículo$A)
prom <- length(artículo$A)
Promediow <- promedio/prom

#Calcular la mediana
mi.mediana(artículo$A)

#Calcular moda

mi.moda <- function(x) { freq <- table(x) 
des <- freq[which.max(x)]    }

moda <- mi.moda(artículo$A)

#gráficar histograma

hist(artículo[,2], xlab= "Body", col= "papayawhip", xlim= c( 135, 260), main = "Body Length")
lines(density(artículo[,2]), col = "red", lwd = 2)
abline(v= mi.mediana(artículo[,2]), col= "palevioletred3", lwd = 2)
abline(v= Promediow, col= "saddlebrown", lwd=1)
abline(v= moda, col= "seagreen1", lwd=2)

legend(x = "topright",c("Density plot", "Median", "Mean", "Moda"),
col = c("red", "palevioletred3", "saddlebrown", "seagreen1"), lwd = c(3, 3, 2,2))

##Cálculos para la variable "Tubercles 1b apart", denominada en el archivo como "P"

#Calcular la media

promedio2 <- sum(artículo$P)
prom2 <- length(artículo$P)
Promediot <- promedio2/prom2

#Calcular la mediana
mi.mediana(artículo$P)

#Calcular moda

moda2 <- mi.moda(artículo$P)

#gráficar histograma

hist(artículo[,16], xlab= "Tubercles", xlim= c(10, 21), ylim= c(0, 20), main= "Tubercles 1b apart" ,breaks= 15, col = "thistle")
lines(density(artículo[,16]), col = "blue", lwd = 2)
abline(v= mi.mediana(artículo[,16]), col= "palevioletred3", lwd = 2)
abline(v= Promediot, col= "saddlebrown", lwd=1)
abline(v= 16.43, col= "seagreen1", lwd=2)

legend(x = "topright",c("Density plot", "Median", "Mean", "Moda"),
       col = c("blue", "palevioletred3", "saddlebrown", "seagreen1"), lwd = c(3, 3, 2,2))


#Cálculos para la variable "Tarsus I lenght=T", denominada en el archivo como "P"

#Calcular la media

promedio3 <- sum(artículo$W)
prom3 <- length(artículo$W)
Promediow <- promedio3/prom3

#Calcular la mediana
mi.mediana(artículo$W)

#Calcular moda

moda2 <- mi.moda(artículo$W)

#gráficar histograma

hist(artículo$W, col= "turquoise", xlim= c(3, 10), breaks = 12, main = "Tarsus I lengh")
lines(density(artículo$W), col = "blue", lwd = 2)
abline(v= mi.mediana(artículo$W), col= "palevioletred3", lwd = 2)
abline(v= Promediow, col= "saddlebrown", lwd=1)
abline(v= 6.5, col= "seagreen1", lwd=2)

legend(x = "topright",c("Density plot", "Median", "Mean", "Moda"),
       col = c("blue", "palevioletred3", "saddlebrown", "seagreen1"), lwd = c(3, 3, 2,2))

